<!-- index.html - ×’×œ×¨×™×” ×ª×œ×ª-×××“×™×ª ×¡×™×™×‘×¨ ×¢× HUD ××©×•×“×¨×’ ×›×•×œ×œ ×©×¢×•×Ÿ -->
<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>×’×œ×¨×™×” ×ª×œ×ª-×××“×™×ª ×¡×™×™×‘×¨ ×“×™× ××™×ª</title>
  <style>
    /* ×‘×¡×™×¡ ×•×¨×¡×¤×•× ×¡×™×‘×™×•×ª */
    html, body { margin:0; padding:0; width:100%; height:100%; overflow:hidden; background:#000; touch-action:none; }
    canvas { display:block; width:100%; height:100%; }

    /* HUD ×•×’×™×œ×•×™/×”×¡×ª×¨×” - ××•×¡×ª×¨ ×œ×—×œ×•×˜×™×Ÿ */
    #hudTab {
      display: none; /* ×”×¡×ª×¨×ª ×›×¤×ª×•×¨ ×”-HUD ×œ×—×œ×•×˜×™×Ÿ */
    }

    #hud {
      display: none; /* ×”×¡×ª×¨×ª ×œ×•×— ×”-HUD ×œ×—×œ×•×˜×™×Ÿ */
    }
    /* ×›×œ ×©××¨ ×¡×’× ×•× ×•×ª ×”-HUD ×”××§×•×¨×™×™× × ×©××¨×™× ××š ××™× × ×¨×œ×•×•× ×˜×™×™× ×›×©×”××œ×× ×˜ ××•×¡×ª×¨ */
    #hudTab {
      position:absolute; top:8px; right:8px;
      width:32px; height:32px;
      background:rgba(0,0,0,0.6); border:2px solid #0f0;
      border-radius:4px 0 0 4px; z-index:101;
      display:flex; align-items:center; justify-content:center;
      cursor:pointer;
    }
    #hudTab .icon { color:#0f0; font-size:20px; text-shadow:0 0 5px #0f0; }

    #hud {
      position:absolute; top:8px; right:40px;
      width:calc(100% - 56px); max-width:320px; max-height:90vh; overflow-y:auto;
      background:rgba(0,0,0,0.6); border:2px solid #0f0; border-radius:8px;
      padding:8px; box-sizing:border-box;
      font-family:monospace; font-size:14px; color:#0f0; z-index:100;
    }
    #hud.hidden { display:none; }
    #hud label { display:flex; align-items:center; margin:6px 0; }
    #hud label .icon { margin-left:6px; color:#0f0; text-shadow:0 0 5px #0f0; }
    #hud label span { flex:1; }
    #hud input[type=range] {
      -webkit-appearance:none; width:100%; height:8px; border-radius:4px;
      background:linear-gradient(to right, #0f0 0%, #f00 100%);
      outline:none; margin-top:4px;
    }
    #hud input[type=range]::-webkit-slider-thumb {
      -webkit-appearance:none; width:16px; height:16px; border-radius:50%; background:#0f0; cursor:pointer; border:2px solid #000;
    }
    #hud input[type=range]::-moz-range-thumb {
      width:16px; height:16px; border-radius:50%; background:#0f0; cursor:pointer; border:2px solid #000;
    }

    /* ×©×¢×•×Ÿ ×•×ª××¨×™×š */
    #clock {
      text-align:center; margin:8px 0;
      font-family:monospace; font-size:16px; color:#ff0;
      text-shadow:0 0 8px #ff0;
    }

    /* ××•×“××œ */
    .modal { position:fixed; top:0; left:0; width:100%; height:100%; display:flex;
      align-items:center; justify-content:center;
      background:rgba(0,0,0,1); visibility:hidden; opacity:0; transition:opacity .4s; z-index:50;
    }
    .modal.visible { visibility:visible; opacity:1; }
    .modal img {
      max-width:90%; max-height:90%; border-radius:8px;
      transform:scale(0.7); opacity:0;
      transition:transform .4s ease, opacity .4s ease;
      box-shadow:0 0 20px #0f0;
    }
    .modal.visible img { transform:scale(1); opacity:1; }

    /* ×˜×§×¡×˜×™× ×¡×™×™×‘×¨ */
    .cyber-text { position:absolute; color:#0f0; font-family:'Courier New',monospace; font-size:16px;
      pointer-events:none; animation:flicker var(--blinkSpeed,2s) infinite; opacity:0.6;
    }
    @keyframes flicker { 0%,100%{opacity:0.2;} 50%{opacity:0.8;} }
  </style>
</head>
<body>
  <!-- ×œ×—×¦×Ÿ HUD ×¢× ××™×™×§×•×Ÿ ×¡×™×™×‘×¨ -->
  <div id="hudTab"><span class="icon">âš™</span></div>
  <!-- HUD -->
  <div id="hud">
    <div id="clock"></div>
    <label><span class="icon">ğŸ“</span><span>×§×•×‘×¥: <span id="fileCount">21</span></span><input id="fileInputHud" type="file" accept="image/*" multiple></label>
    <label><span class="icon">ğŸ”„</span><span>××”×™×¨×•×ª ×¡×™×‘×•×‘ <span id="rotateVal">0.0004</span></span><input id="rotateSlider" type="range" min="0" max="0.02" step="0.0001" value="0.0004"></label>
    <label><span class="icon">âœ¨</span><span>××”×™×¨×•×ª ×›×•×›×‘×™× <span id="starVal">0.0042</span></span><input id="starSlider" type="range" min="0" max="0.01" step="0.0001" value="0.0042"></label>
    <label><span class="icon">âš¡</span><span>××”×™×¨×•×ª ×”×‘×”×•×‘ <span id="blinkVal">0.026</span></span><input id="blinkSlider" type="range" min="0" max="0.05" step="0.001" value="0.026"></label>
    <label><span class="icon">ğŸ”</span><span>×’×•×“×œ ×’×œ×•×‘×œ×™ <span id="scaleVal">0.6</span></span><input id="scaleSlider" type="range" min="0.1" max="2" step="0.1" value="0.6"></label>
    <label><span class="icon">ğŸ“</span><span>×¢×•×‘×™ ××¡×’×¨×•×ª <span id="frameWidthVal">1</span></span><input id="frameWidthSlider" type="range" min="1" max="12" step="1" value="1"></label>
    <label><span class="icon">â˜ï¸</span><span>×©×§×™×¤×•×ª ××¡×’×¨×•×ª <span id="frameOpacityVal">0</span></span><input id="frameOpacitySlider" type="range" min="0" max="1" step="0.1" value="0"></label>
    <label><span class="icon">â­</span><span>×’×•×“×œ ×›×•×›×‘×™× <span id="starSizeVal">5.5</span></span><input id="starSizeSlider" type="range" min="0.5" max="8" step="0.5" value="5.5"></label>
    <label><span class="icon">ğŸŒŒ</span><span>××¡×¤×¨ ×›×•×›×‘×™× <span id="starCountVal">2000</span></span><input id="starCountSlider" type="range" min="100" max="3000" step="100" value="2000"></label>
    <label><span class="icon">ğŸŒ </span><span>×©×§×™×¤×•×ª ×ª××•× ×•×ª <span id="imgOpacityVal">1</span></span><input id="imgOpacitySlider" type="range" min="0" max="1" step="0.1" value="1"></label>
  </div>

  <!-- ××•×“××œ ×œ×”×¦×’×ª ×ª××•× ×” -->
  <div id="modal" class="modal"><img id="modalImg" src="" onerror="this.src='https://placehold.co/400x300/FF0000/FFFFFF?text=Error'"></div>

  <!-- ×¡×¤×¨×™×•×ª Three.js -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.134.0/build/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.134.0/examples/js/controls/OrbitControls.js"></script>
  <script>
    // ×”×’×“×¨×•×ª ×¨××©×•× ×™×•×ª ×œ××©×ª× ×™×
    const maxImages = 333; // ××¡×¤×¨ ×”×ª××•× ×•×ª ×”××§×¡×™××œ×™ ×©× ×™×ª×Ÿ ×œ×˜×¢×•×Ÿ
    let autoRotateSpeed = 0.0004; // ××”×™×¨×•×ª ×”×¡×™×‘×•×‘ ×”××•×˜×•××˜×™ ×©×œ ×”×’×œ×¨×™×”
    let starRotSpeed = 0.0042; // ××”×™×¨×•×ª ×¡×™×‘×•×‘ ×”×›×•×›×‘×™×
    let blinkSpeed = 0.026; // ××”×™×¨×•×ª ×”×‘×”×•×‘ ×”××¡×’×¨×•×ª
    let globalScale = 0.6; // ×§× ×” ××™×“×” ×’×œ×•×‘×œ×™ ×©×œ ×”×¡×¦× ×”
    let frameWidth = 1; // ×¢×•×‘×™ ×”××¡×’×¨×•×ª ×¡×‘×™×‘ ×”×ª××•× ×•×ª
    let frameOpacity = 0; // ×©×§×™×¤×•×ª ×”××¡×’×¨×•×ª
    let starSize = 5.5; // ×’×•×“×œ ×”×›×•×›×‘×™×
    let starCount = 2000; // ××¡×¤×¨ ×”×›×•×›×‘×™×
    let imgOpacity = 1; // ×©×§×™×¤×•×ª ×”×ª××•× ×•×ª

    // ××¢×¨×š ×œ××—×¡×•×Ÿ ×¤×¨×˜×™ ×”×ª××•× ×•×ª. ××œ×• ×”×ª××•× ×•×ª ×©× ×˜×¢× ×•×ª ×›×‘×¨×™×¨×ª ××—×“×œ.
    let imageItems = [
      { url: "https://raw.githubusercontent.com/orengamchi/i24_gui_v2/main/%D7%A9%D7%A8%D7%95%D7%9F_%D7%A0%D7%99%D7%A1%D7%99%D7%9D.png", name: "×©×¨×•×Ÿ_× ×™×¡×™×" },
      { url: "https://raw.githubusercontent.com/orengamchi/i24_gui_v2/main/%D7%A9%D7%A8%D7%95%D7%9F_%D7%92%D7%9C_THUMB.png", name: "×©×¨×•×Ÿ_×’×œ_THUMB" },
      { url: "https://raw.githubusercontent.com/orengamchi/i24_gui_v2/main/%D7%A6%D7%91%D7%99%D7%A7%D7%94_%D7%99%D7%97%D7%96%D7%A7%D7%9C%D7%99.png", name: "×¦×‘×™×§×”_×™×—×–×§××œ×™" },
      { url: "https://raw.githubusercontent.com/orengamchi/i24_gui_v2/main/%D7%A1%D7%99%D7%A8%D7%99%D7%9C_%D7%A2%D7%9E%D7%A8.png", name: "×¡×™×¨×™×œ_×¢××¨" },
      { url: "https://raw.githubusercontent.com/orengamchi/i24_gui_v2/main/%D7%A1%D7%99%D7%95%D7%95%D7%9F_%D7%A0%D7%93%D7%91_%D7%92%D7%93%D7%95%D7%9C.png", name: "×¡×™×•×•×Ÿ_× ×“×‘_×’×“×•×œ" },
      { url: "https://raw.githubusercontent.com/orengamchi/i24_gui_v2/main/%D7%A1%D7%99%D7%95%D7%95%D7%9F_%D7%A0%D7%93%D7%91.png", name: "×¡×™×•×•×Ÿ_× ×“×‘" },
      { url: "https://raw.githubusercontent.com/orengamchi/i24_gui_v2/main/%D7%A0%D7%99%D7%91_%D7%92%D7%9C%D7%91%D7%95%D7%A2.png", name: "× ×™×‘_×’×œ×‘×•×¢" },
      { url: "https://raw.githubusercontent.com/orengamchi/i24_gui_v2/main/%D7%A0%D7%95%D7%95%D7%94_%D7%93%D7%A8%D7%95%D7%9E%D7%99_%D7%92%D7%93%D7%95%D7%9C.png", name: "× ×•×•×”_×“×¨×•××™_×’×“×•×œ" },
      { url: "https://raw.githubusercontent.com/orengamchi/i24_gui_v2/main/%D7%9E%D7%99%D7%A8%D7%99_%D7%9E%D7%99%D7%9B%D7%90%D7%9C%D7%91.png", name: "××™×¨×™_××™×›××œ×™_×’×“×•×œ" },
      { url: "https://raw.githubusercontent.com/orengamchi/i24_gui_v2/main/%D7%9E%D7%99%D7%A8%D7%99_%D7%9E%D7%99%D7%9B%D7%90%D7%9C%D7%99.png", name: "××™×¨×™_××™×›××œ×™" },
      { url: "https://raw.githubusercontent.com/orengamchi/i24_gui_v2/main/%D7%99%D7%A0%D7%95%D7%9F_%D7%9E%D7%99%D7%9C%D7%A1.png", name: "×™× ×•×Ÿ_××™×œ×¡" },
      { url: "https://raw.githubusercontent.com/orengamchi/i24_gui_v2/main/%D7%99%D7%95%D7%A1%D7%99_%D7%99%D7%94%D7%95%D7%A9%D7%95%D7%A2.png", name: "×™×•×¡×™_×™×”×•×©×•×¢" },
      { url: "https://raw.githubusercontent.com/orengamchi/i24_gui_v2/main/%D7%97%D7%92%D7%99_%D7%92%D7%95%D7%9C%D7%9F.png", name: "×—×’×™_×’×•×œ×Ÿ" },
      { url: "https://raw.githubusercontent.com/orengamchi/i24_gui_v2/main/%D7%93%D7%A0%D7%99%D7%90%D7%9C_%D7%A8%D7%95%D7%98_%D7%92%D7%93%D7%95%D7%9C.png", name: "×“× ×™××œ_×¨×•×˜_×’×“×•×œ" },
      { url: "https://raw.githubusercontent.com/orengamchi/i24_gui_v2/main/%D7%93%D7%A0%D7%99%D7%90%D7%9C_%D7%A8%D7%95%D7%98.png", name: "×“× ×™××œ_×¨×•×˜" },
      { url: "https://raw.githubusercontent.com/orengamchi/i24_gui_v2/main/%D7%90%D7%9C%D7%99%D7%A8%D7%96_%D7%A9%D7%93%D7%94_%D7%92%D7%93%D7%95%D7%9C.png", name: "××œ×™×¨×–_×©×“×”_×’×“×•×œ" },
      { url: "https://raw.githubusercontent.com/orengamchi/i24_gui_v2/main/%D7%90%D7%9C%D7%99%D7%A8%D7%96_%D7%A9%D7%93%D7%94.png", name: "××œ×™×¨×–_×©×“×”" },
      { url: "https://raw.githubusercontent.com/orengamchi/i24_gui_v2/main/%D7%90%D7%9C%D7%99_%D7%94%D7%95%D7%9B%D7%A0%D7%91%D7%A8%D7%92.png", name: "××œ×™_×”×•×›× ×‘×¨×’" },
      { url: "https://raw.githubusercontent.com/orengamchi/i24_gui_v2/main/%D7%90%D7%95%D7%A8%D7%99_%D7%A7%D7%95%D7%95%D7%90%D7%9C.png", name: "××•×¨×™_×§×•×•××œ" },
      { url: "https://cdn.jsdelivr.net/gh/orengamchi/i24_gui_v2@main/%D7%9E%D7%99%D7%9B%D7%90%D7%9C_%D7%A8%D7%91%D7%99%D7%A0%D7%95%D7%91%D7%99%D7%A5_THUMB.png", name: "××™×›×œ_×¨×‘×™× ×•×‘×™×¥" }
    ];

    // ×”×’×“×¨×ª ×¡×¦× ×ª Three.js
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(60, innerWidth / innerHeight, 0.1, 2000);
    camera.position.z = 350; // ××™×§×•× ×”××¦×œ××”
    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(innerWidth, innerHeight);
    document.body.appendChild(renderer.domElement);

    // ×”×’×“×¨×ª ×©×œ×™×˜×” ×‘××¦×œ××” (OrbitControls)
    const controls = new THREE.OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true; // ×”×¤×¢×œ×ª ×©×™×›×•×š ×œ×ª× ×•×¢×” ×—×œ×§×” ×™×•×ª×¨
    controls.autoRotate = false; // ×›×™×‘×•×™ ×¡×™×‘×•×‘ ××•×˜×•××˜×™ ×©×œ ×”××¦×œ××”

    // Raycaster ×œ×–×™×”×•×™ ×œ×—×™×¦×•×ª ×¢×œ ××•×‘×™×™×§×˜×™×
    const raycaster = new THREE.Raycaster();
    const mouse = new THREE.Vector2();

    // ×§×‘×•×¦×” ×œ××—×¡×•×Ÿ ×›×œ ×”×ª××•× ×•×ª ×•×”××¡×’×¨×•×ª, ×•××¢×¨×š ×œ××¡×’×¨×•×ª ×‘×œ×‘×“
    const group = new THREE.Group();
    const frames = [];
    let stars; // ××©×ª× ×” ×œ××•×‘×™×™×§×˜ ×”×›×•×›×‘×™×

    // ×¤×•× ×§×¦×™×” ×œ×¢×“×›×•×Ÿ ×”×©×¢×•×Ÿ ×”×“×™×’×™×˜×œ×™
    function updateClock() {
      const now = new Date();
      const date = now.toLocaleDateString('he-IL', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
      const time = now.toLocaleTimeString('he-IL');
      document.getElementById('clock').textContent = `${date} ${time}`;
    }
    // ×”×¤×¢×œ×ª ×¢×“×›×•×Ÿ ×”×©×¢×•×Ÿ ×›×œ ×©× ×™×™×” ×•×¢×“×›×•×Ÿ ×¨××©×•× ×™
    setInterval(updateClock, 1000);
    updateClock();

    // ×‘× ×™×™×ª ×”×¡×¦× ×”, ×”×’×“×¨×ª ×”-HUD ×•×”×ª×—×œ×ª ×”×× ×™××¦×™×”
    buildScene();
    setupHUD();
    animate();

    // ×¤×•× ×§×¦×™×” ×œ×‘× ×™×™×ª (××• ×‘× ×™×™×” ××—×“×©) ×©×œ ×”×¡×¦× ×” ×”×ª×œ×ª-×××“×™×ª
    function buildScene() {
      group.clear(); // × ×™×§×•×™ ×”×§×‘×•×¦×” ×”× ×•×›×—×™×ª
      frames.length = 0; // ××™×¤×•×¡ ××¢×¨×š ×”××¡×’×¨×•×ª
      if (stars) scene.remove(stars); // ×”×¡×¨×ª ×”×›×•×›×‘×™× ×”×§×™×™××™× ×× ×™×©× ×

      // ×™×¦×™×¨×ª ××¢×¨×š ×›×•×›×‘×™× ×¨× ×“×•××œ×™
      const geom = new THREE.BufferGeometry(), pos = new Float32Array(starCount * 3);
      for (let i = 0; i < starCount; i++) {
        pos[i * 3] = (Math.random() - 0.5) * 2000;
        pos[i * 3 + 1] = (Math.random() - 0.5) * 2000;
        pos[i * 3 + 2] = (Math.random() - 0.5) * 2000;
      }
      geom.setAttribute('position', new THREE.BufferAttribute(pos, 3));
      stars = new THREE.Points(geom, new THREE.PointsMaterial({ color: 0xffffff, size: starSize, transparent: true, opacity: 1 }));
      scene.add(stars);

      // ×—×™×©×•×‘ ×’×•×“×œ ×”×ª××•× ×•×ª ×‘×”×ª×‘×¡×¡ ×¢×œ ××¡×¤×¨×Ÿ
      const baseSize = 60, factor = Math.sqrt(maxImages / imageItems.length);
      const w = baseSize * factor * globalScale, h = w * 0.75; // ×¨×•×—×‘ ×•×’×•×‘×” ×”×ª××•× ×” (×™×—×¡ 4:3)

      const radius = 200; // ×¨×“×™×•×¡ ×”×’×œ×•×‘×•×¡
      const phiStep = Math.PI * (3 - Math.sqrt(5)); // ××¨×•×•×— ×–×•×•×™×ª×™ ×œ×¤×™ ×¤×™×‘×•× ××¦'×™ ×›×“×™ ×œ×¤×–×¨ ××ª ×”×ª××•× ×•×ª ×‘××•×¤×Ÿ ××—×™×“

      // ×™×¦×™×¨×ª ×ª××•× ×•×ª, ××¡×’×¨×•×ª ×•×˜×§×¡×˜ ×¢×‘×•×¨ ×›×œ ×¤×¨×™×˜
      imageItems.forEach((item, i) => {
        // ×—×™×©×•×‘ ××™×§×•× ×”×ª××•× ×” ×¢×œ ×›×“×•×¨
        const y = 1 - (i / (imageItems.length - 1)) * 2;
        const rY = Math.sqrt(1 - y * y);
        const theta = phiStep * i;
        const x = Math.cos(theta) * radius * rY;
        const z = Math.sin(theta) * radius * rY;

        // ×™×¦×™×¨×ª ××™×©×•×¨ ×œ×ª××•× ×”
        const geo = new THREE.PlaneGeometry(w, h);
        const textureLoader = new THREE.TextureLoader(); // ×™×¦×™×¨×ª ×˜×•×¢×Ÿ ×˜×§×¡×˜×•×¨×•×ª
        textureLoader.crossOrigin = 'anonymous'; // ×”×’×“×¨×” ×œ×˜×™×¤×•×œ ×‘×‘×¢×™×•×ª CORS
        const mat = new THREE.MeshBasicMaterial({
          map: textureLoader.load(
            item.url,
            // onLoad callback
            (texture) => {
              console.log(`Image loaded successfully: ${item.name} from ${item.url}`);
            },
            // onProgress callback (optional)
            undefined,
            // onError callback - ×™×“×¤×™×¡ ×©×’×™××” ×œ×§×•× ×¡×•×œ×ª ×”××¤×ª×—×™× ×× ×”×˜×¢×™× ×” × ×›×©×œ×ª
            (error) => {
              console.error(`Error loading image ${item.name} from ${item.url}:`, error);
            }
          ),
          side: THREE.DoubleSide,
          transparent: true,
          opacity: imgOpacity
        });
        const mesh = new THREE.Mesh(geo, mat);
        mesh.position.set(x, y * radius, z);
        mesh.lookAt(0, 0, 0); // ×¡×™×‘×•×‘ ×”×ª××•× ×” ×©×ª×¤× ×” ×œ××¨×›×–
        mesh.userData = { url: item.url }; // ×©××™×¨×ª ×”-URL ×œ×©×™××•×© ×‘××•×“××œ
        group.add(mesh);

        // ×™×¦×™×¨×ª ××¡×’×¨×ª ×œ×ª××•× ×”
        const edge = new THREE.EdgesGeometry(geo);
        const eMat = new THREE.LineBasicMaterial({ color: 0x0f0, linewidth: frameWidth, transparent: true, opacity: frameOpacity });
        const frame = new THREE.LineSegments(edge, eMat);
        frame.position.copy(mesh.position);
        frame.rotation.copy(mesh.rotation);
        group.add(frame);
        frames.push(frame); // ×©××™×¨×” ×‘××¢×¨×š ×”××¡×’×¨×•×ª ×œ×”×‘×”×•×‘

        // ×™×¦×™×¨×ª ×˜×§×¡×˜ ×©× ×”×ª××•× ×” ××¢×œ ×”×ª××•× ×”
        const cvs = document.createElement('canvas');
        cvs.width = 256;
        cvs.height = 64;
        const ctx = cvs.getContext('2d');
        ctx.font = '24px sans-serif';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillStyle = '#f00';
        ctx.shadowColor = '#f00';
        ctx.shadowBlur = 10;
        ctx.fillText(item.name, 128, 32);
        const txt = new THREE.CanvasTexture(cvs);
        const sprMat = new THREE.SpriteMaterial({ map: txt, transparent: true });
        const spr = new THREE.Sprite(sprMat);
        spr.scale.set(w, h * 0.25, 1);
        spr.position.set(x, y * radius - h / 2 - 20, z); // ××™×§×•× ×”×˜×§×¡×˜ ××ª×—×ª ×œ×ª××•× ×”
        spr.lookAt(camera.position); // ×”×˜×§×¡×˜ ×ª××™×“ ×™×¤× ×” ×œ××¦×œ××”
        group.add(spr);
      });
      scene.add(group);
      createCyberTexts(); // ×™×¦×™×¨×ª ×˜×§×¡×˜×™× ××§×¨××™×™× ×‘×¡×¦× ×”
    }

    // ××™×¨×•×¢ ×œ×—×™×¦×” ×¢×œ ×›×¤×ª×•×¨ ×”-HUD ×œ×”×¦×’×”/×”×¡×ª×¨×”
    document.getElementById('hudTab').addEventListener('click', () => {
      document.getElementById('hud').classList.toggle('hidden');
    });

    // ×¤×•× ×§×¦×™×” ×œ×™×¦×™×¨×ª ×˜×§×¡×˜×™× "×¡×™×™×‘×¨" ××§×¨××™×™× ×¢×œ ×”××¡×š
    function createCyberTexts() {
      // ×”×¡×¨×ª ×˜×§×¡×˜×™× ×§×™×™××™×
      document.querySelectorAll('.cyber-text').forEach(e => e.remove());
      const samples = ['01010101', 'H4CK3R', 'CY8ER', 'â–“â–“â–“â–“', 'áš á›Ÿá›‹', 'BO0T', 'C0D3', 'SYS', 'â–ˆâ–ˆâ–ˆ', 'NE0N'];
      samples.forEach((s, i) => {
        const el = document.createElement('div');
        el.className = 'cyber-text';
        el.textContent = s;
        el.style.top = Math.random() * 90 + '%';
        el.style.left = Math.random() * 90 + '%';
        document.body.appendChild(el);
      });
      // ×”×•×¡×¤×ª ×˜×§×¡×˜ ×§×‘×•×¢ ×œ××™×ª×•×’
      const fix = document.createElement('div');
      fix.className = 'cyber-text';
      fix.textContent = 'orengamchi.com';
      fix.style.color = '#ff0';
      fix.style.top = '5%';
      fix.style.left = '5%';
      fix.style.animation = 'none'; // ×œ×œ× ×”×‘×”×•×‘
      document.body.appendChild(fix);
    }

    // ×¤×•× ×§×¦×™×” ×œ×”×’×“×¨×ª ×‘×§×¨×•×ª ×”-HUD
    function setupHUD() {
      // ×¢×“×›×•×Ÿ ××¡×¤×¨ ×”×§×‘×¦×™× ×”××•×¦×’×™×
      document.getElementById('fileCount').textContent = imageItems.length;
      // ×˜×™×¤×•×œ ×‘×”×¢×œ××ª ×§×‘×¦×™× ×—×“×©×™×
      document.getElementById('fileInputHud').addEventListener('change', e => {
        const files = Array.from(e.target.files).slice(0, maxImages);
        let arr = [], l = 0;
        if (files.length === 0) return; // ×× ×œ× × ×‘×—×¨×• ×§×‘×¦×™×, ×¦×
        files.forEach(f => {
          const r = new FileReader();
          r.onload = ev => {
            arr.push({ url: ev.target.result, name: f.name });
            l++;
            if (l === files.length) {
              imageItems = arr;
              document.getElementById('fileCount').textContent = imageItems.length;
              buildScene(); // ×‘× ×™×™×” ××—×“×© ×©×œ ×”×¡×¦× ×” ×¢× ×”×ª××•× ×•×ª ×”×—×“×©×•×ª
            }
          };
          r.readAsDataURL(f); // ×§×¨×™××ª ×”×§×•×‘×¥ ×›-Data URL
        });
      });

      // ××™×¤×•×™ ×”×¡×œ×™×™×“×¨×™× ×œ×¤×•× ×§×¦×™×•×ª ×”×¢×“×›×•×Ÿ ×©×œ×”×
      const map = {
        rotateSlider: v => autoRotateSpeed = v,
        starSlider: v => starRotSpeed = v,
        blinkSlider: v => blinkSpeed = v,
        scaleSlider: v => { globalScale = v; buildScene(); }, // ×“×•×¨×© ×‘× ×™×™×” ××—×“×©
        frameWidthSlider: v => { frameWidth = v; buildScene(); }, // ×“×•×¨×© ×‘× ×™×™×” ××—×“×©
        frameOpacitySlider: v => frameOpacity = v,
        starSizeSlider: v => { starSize = v; if (stars) stars.material.size = v; }, // ×¢×“×›×•×Ÿ ×™×©×™×¨
        starCountSlider: v => { starCount = v; buildScene(); }, // ×“×•×¨×© ×‘× ×™×™×” ××—×“×©
        imgOpacitySlider: v => { imgOpacity = v; buildScene(); } // ×“×•×¨×© ×‘× ×™×™×” ××—×“×©
      };
      // ×œ×•×œ××” ×¢×œ ×›×œ ×”×¡×œ×™×™×“×¨×™× ×•×”×¦××“×ª ××™×¨×•×¢×™×
      Object.entries(map).forEach(([id, fn]) => {
        const inp = document.getElementById(id),
              val = document.getElementById(id.replace('Slider', 'Val'));
        inp.addEventListener('input', e => {
          const v = parseFloat(e.target.value);
          fn(v); // ×”×¤×¢×œ×ª ×¤×•× ×§×¦×™×™×ª ×”×¢×“×›×•×Ÿ
          val.textContent = v; // ×¢×“×›×•×Ÿ ×¢×¨×š ×”×ª×¦×•×’×”
        });
        val.textContent = inp.value; // ×¢×“×›×•×Ÿ ×¢×¨×š ×¨××©×•× ×™
      });
    }

    // ×¤×•× ×§×¦×™×™×ª ×”×× ×™××¦×™×” ×”×¨××©×™×ª
    function animate() {
      requestAnimationFrame(animate); // ×§×¨×™××” ×—×•×–×¨×ª ×œ×¤×•× ×§×¦×™×”
      group.rotation.y += autoRotateSpeed; // ×¡×™×‘×•×‘ ×”×’×œ×¨×™×”
      if (stars) stars.rotation.y += starRotSpeed; // ×¡×™×‘×•×‘ ×”×›×•×›×‘×™×
      // ×”×‘×”×•×‘ ×”××¡×’×¨×•×ª
      frames.forEach((f, i) => f.material.opacity = frameOpacity + 0.3 * Math.sin(Date.now() * blinkSpeed + i));
      controls.update(); // ×¢×“×›×•×Ÿ ×‘×§×¨×•×ª ×”××¦×œ××” (×œ×©×™×›×•×š)
      renderer.render(scene, camera); // ×¨×™× ×“×•×¨ ×”×¡×¦× ×”
    }

    // ××™×¨×•×¢ ×œ×—×™×¦×” ×›×¤×•×œ×” ×œ×¤×ª×™×—×ª/×¡×’×™×¨×ª ××•×“××œ ×”×ª××•× ×”
    window.addEventListener('dblclick', e => {
      e.preventDefault();
      const m = document.getElementById('modal');
      if (m.classList.contains('visible')) {
        m.classList.remove('visible'); // ×¡×’×™×¨×ª ×”××•×“××œ ×× ×”×•× ×¤×ª×•×—
      } else {
        // ×–×™×”×•×™ ××•×‘×™×™×§×˜ ×‘××¨×—×‘ ×”×ª×œ×ª-×××“×™ ×‘×œ×—×™×¦×” ×›×¤×•×œ×”
        mouse.set((e.clientX / innerWidth) * 2 - 1, -(e.clientY / innerHeight) * 2 + 1);
        raycaster.setFromCamera(mouse, camera);
        const hit = raycaster.intersectObjects(group.children.filter(o => o.userData)); // ×¡×™× ×•×Ÿ ×¨×§ ××•×‘×™×™×§×˜×™× ×¢× userData (×”×ª××•× ×•×ª)
        if (hit.length) {
          document.getElementById('modalImg').src = hit[0].object.userData.url; // ×”×¦×’×ª ×”×ª××•× ×” ×‘××•×“××œ
          m.classList.add('visible'); // ×¤×ª×™×—×ª ×”××•×“××œ
        }
      }
    });

    // ××™×¨×•×¢ ×©×™× ×•×™ ×’×•×“×œ ×—×œ×•×Ÿ - ×œ×”×ª×××” ×¨×¡×¤×•× ×¡×™×‘×™×ª
    window.addEventListener('resize', () => {
      camera.aspect = innerWidth / innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(innerWidth, innerHeight);
    });
  </script>
</body>
</html>
